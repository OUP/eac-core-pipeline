-- Change DLP teacher products from activation code to admin registerable. Existing tokens for tecaher products should be moved to a single 'teacher product' UAT only
-- move teacher batches to single teacher validation product
update activation_code_batch set activation_code_registration_definition_id = 'D1AA1B67-725F-4F52-A028-ED0F8B86DD00' where db_name() = 'eacuat' and id in (select t2.id from activation_code_batch t2, registration_definition t3 where t3.id = t2.activation_code_registration_definition_id and t3.product_id in ('c29c77bc-d56c-4e90-a2bc-8a4864bfad32','86d350c8-0d2f-42a5-af75-a35029a5ff49','4faafc5d-a574-409d-97d8-443eeddf01d7','66519916-19bb-4a70-885d-1a81d1b684b9','937645ab-c28e-4a03-bc10-3b84d2e70629','04194c30-b89e-4556-928f-5737de225d71','0bc82234-9fe4-4cdd-aeec-e469d5e3b7f7','b07bded6-ab52-4947-a1c9-95d3c75f8a3a','d91983fb-cc5d-4b76-8891-1ca0ed5bcca2','af122523-2451-480d-9eff-33b9086cea2b','629d5bf3-7670-4b2a-8db4-3f83cd89cce8','31ff7ccd-8071-4050-b054-28a3d90b2bf6','e7011fb3-7590-4fce-bb7a-4eaa012d4451','aa1a73ef-4518-433c-a110-e4602b97ef4e','b03cf9db-7abf-4886-a71d-23f74793b320','c5088eec-08b3-4d93-bfaa-b7fca4e7df8d','c51b24d1-f98f-4ef9-819a-bfdb548592d9','d2c0a261-ef30-4842-943e-0f5aa0ebc8e2','51f420d2-0f6d-41cf-9ba9-fbb0536f4e32','0d0da568-0fe8-495f-8d17-7c12e9b7c206','6e429b4b-129f-4b47-8c5c-223b42feedf3','ada6e6b0-d1aa-4225-a17e-40750edb7d82','e7e8c580-b5e9-40f9-a99c-ab5e477d9954','78bc87e3-272c-4e85-b321-d2c3ddf9a84b','7a30d089-6512-4692-84a2-96c99cbdd2c1','e0441f3e-bc07-4fc9-950a-c0f027df55a9','0E1AAC43-72F0-4D94-8ACE-F788C256D9F4','b1bc32dc-6f2e-4682-825c-4558069a7a95','1bd91d62-f3c5-4c20-8c7f-1b6b31d0494e','e2a98c11-e239-4e62-9ad7-d72b9db4d4b3','c24ff181-f18a-4531-b66d-ffa89be190fd','c564ac4c-1fdd-4b20-bc1d-22444ddcc887','c8842115-59f1-4722-a253-5316019a94de','432e03e4-f2b8-4efd-aa20-4788e01880ca','4b0b0cc9-66c5-41f5-84a7-926fe04bd9d2','e57bbc59-fbdb-44af-b32f-c37636c19714','7d2287fe-b71e-45ae-90a3-1f17b30afdb0','36c96102-9902-4117-b467-08d0bde99e95','65c8cd42-5e4d-42cb-b2e4-6ae60613cdcf','63a6e2a5-2960-48e9-8388-54c3307566a3','2b002296-a3f1-409b-912f-01d467e7c0e5','3b1a9e70-7306-4559-877f-b47f2c6329a0'));
-- update teacher products to admin registerable
update product set registerable_type = 'ADMIN_REGISTERABLE' where db_name() = 'eacuat' and id in ('c29c77bc-d56c-4e90-a2bc-8a4864bfad32','86d350c8-0d2f-42a5-af75-a35029a5ff49','4faafc5d-a574-409d-97d8-443eeddf01d7','66519916-19bb-4a70-885d-1a81d1b684b9','937645ab-c28e-4a03-bc10-3b84d2e70629','04194c30-b89e-4556-928f-5737de225d71','0bc82234-9fe4-4cdd-aeec-e469d5e3b7f7','b07bded6-ab52-4947-a1c9-95d3c75f8a3a','d91983fb-cc5d-4b76-8891-1ca0ed5bcca2','af122523-2451-480d-9eff-33b9086cea2b','629d5bf3-7670-4b2a-8db4-3f83cd89cce8','31ff7ccd-8071-4050-b054-28a3d90b2bf6','e7011fb3-7590-4fce-bb7a-4eaa012d4451','aa1a73ef-4518-433c-a110-e4602b97ef4e','b03cf9db-7abf-4886-a71d-23f74793b320','c5088eec-08b3-4d93-bfaa-b7fca4e7df8d','c51b24d1-f98f-4ef9-819a-bfdb548592d9','d2c0a261-ef30-4842-943e-0f5aa0ebc8e2','51f420d2-0f6d-41cf-9ba9-fbb0536f4e32','0d0da568-0fe8-495f-8d17-7c12e9b7c206','6e429b4b-129f-4b47-8c5c-223b42feedf3','ada6e6b0-d1aa-4225-a17e-40750edb7d82','e7e8c580-b5e9-40f9-a99c-ab5e477d9954','78bc87e3-272c-4e85-b321-d2c3ddf9a84b','7a30d089-6512-4692-84a2-96c99cbdd2c1','e0441f3e-bc07-4fc9-950a-c0f027df55a9','0E1AAC43-72F0-4D94-8ACE-F788C256D9F4','b1bc32dc-6f2e-4682-825c-4558069a7a95','1bd91d62-f3c5-4c20-8c7f-1b6b31d0494e','e2a98c11-e239-4e62-9ad7-d72b9db4d4b3','c24ff181-f18a-4531-b66d-ffa89be190fd','c564ac4c-1fdd-4b20-bc1d-22444ddcc887','c8842115-59f1-4722-a253-5316019a94de','432e03e4-f2b8-4efd-aa20-4788e01880ca','4b0b0cc9-66c5-41f5-84a7-926fe04bd9d2','e57bbc59-fbdb-44af-b32f-c37636c19714','7d2287fe-b71e-45ae-90a3-1f17b30afdb0','36c96102-9902-4117-b467-08d0bde99e95','65c8cd42-5e4d-42cb-b2e4-6ae60613cdcf','63a6e2a5-2960-48e9-8388-54c3307566a3','2b002296-a3f1-409b-912f-01d467e7c0e5','3b1a9e70-7306-4559-877f-b47f2c6329a0');
-- change from activation code to standard registration
update registration_definition set registration_definition_type = 'PRODUCT_REGISTRATION' where db_name() = 'eacuat' and product_id in ('c29c77bc-d56c-4e90-a2bc-8a4864bfad32','86d350c8-0d2f-42a5-af75-a35029a5ff49','4faafc5d-a574-409d-97d8-443eeddf01d7','66519916-19bb-4a70-885d-1a81d1b684b9','937645ab-c28e-4a03-bc10-3b84d2e70629','04194c30-b89e-4556-928f-5737de225d71','0bc82234-9fe4-4cdd-aeec-e469d5e3b7f7','b07bded6-ab52-4947-a1c9-95d3c75f8a3a','d91983fb-cc5d-4b76-8891-1ca0ed5bcca2','af122523-2451-480d-9eff-33b9086cea2b','629d5bf3-7670-4b2a-8db4-3f83cd89cce8','31ff7ccd-8071-4050-b054-28a3d90b2bf6','e7011fb3-7590-4fce-bb7a-4eaa012d4451','aa1a73ef-4518-433c-a110-e4602b97ef4e','b03cf9db-7abf-4886-a71d-23f74793b320','c5088eec-08b3-4d93-bfaa-b7fca4e7df8d','c51b24d1-f98f-4ef9-819a-bfdb548592d9','d2c0a261-ef30-4842-943e-0f5aa0ebc8e2','51f420d2-0f6d-41cf-9ba9-fbb0536f4e32','0d0da568-0fe8-495f-8d17-7c12e9b7c206','6e429b4b-129f-4b47-8c5c-223b42feedf3','ada6e6b0-d1aa-4225-a17e-40750edb7d82','e7e8c580-b5e9-40f9-a99c-ab5e477d9954','78bc87e3-272c-4e85-b321-d2c3ddf9a84b','7a30d089-6512-4692-84a2-96c99cbdd2c1','e0441f3e-bc07-4fc9-950a-c0f027df55a9','0E1AAC43-72F0-4D94-8ACE-F788C256D9F4','b1bc32dc-6f2e-4682-825c-4558069a7a95','1bd91d62-f3c5-4c20-8c7f-1b6b31d0494e','e2a98c11-e239-4e62-9ad7-d72b9db4d4b3','c24ff181-f18a-4531-b66d-ffa89be190fd','c564ac4c-1fdd-4b20-bc1d-22444ddcc887','c8842115-59f1-4722-a253-5316019a94de','432e03e4-f2b8-4efd-aa20-4788e01880ca','4b0b0cc9-66c5-41f5-84a7-926fe04bd9d2','e57bbc59-fbdb-44af-b32f-c37636c19714','7d2287fe-b71e-45ae-90a3-1f17b30afdb0','36c96102-9902-4117-b467-08d0bde99e95','65c8cd42-5e4d-42cb-b2e4-6ae60613cdcf','63a6e2a5-2960-48e9-8388-54c3307566a3','2b002296-a3f1-409b-912f-01d467e7c0e5','3b1a9e70-7306-4559-877f-b47f2c6329a0');


-- Update teacher validation product name
update asset set product_name = 'Oxford Learn Teacher Validation' where id = '60CFA546-E842-4A47-BA2A-7215A677838E';
-- Change validation product activation to instant
update registration_definition set registration_activation_id = (select id from registration_activation where activation_type = 'INSTANT') where id = 'D1AA1B67-725F-4F52-A028-ED0F8B86DD00'


-- DLP Course builder product
insert into asset(id,obj_version,erights_id, product_name, division_id) values('E2A3181D-890B-4E3A-BB9D-9C3583967636', 0, 28404, 'Oxford Learn Course Builder', 'bfdc5888-c26b-4ed5-a580-6aa363a25e12');
insert into product (product_type, id ,obj_version, asset_id, landing_page, registerable_product_id, email, service_level_agreement, registerable_type) values ('REGISTERABLE','66B676F8-9338-4515-8288-B581DD0E845A', 0, 'E2A3181D-890B-4E3A-BB9D-9C3583967636', '', null, '', '', 'ADMIN_REGISTERABLE');
insert into registration_definition (registration_definition_type,id,obj_version,product_id,registration_activation_id,page_definition_id,licence_template_id) 
values ('PRODUCT_REGISTRATION', '451AFA5E-EF8A-490A-A19F-826BCF2B946F', 0, '66B676F8-9338-4515-8288-B581DD0E845A', 'D7FEFBDF-94D9-4D15-9579-4EF312E4054E', '8992DD30-D16F-405F-B2C0-7A492491EEC4', '7F6379BD-068B-4455-A3DD-41D878F831DD');


-- Change eltstaff account to shared type
update customer set customer_type = 'SHARED' where username = 'eltstaff';

-- EAC-184 - vary barrier page text depending upon whether licence expired or in the future
update message set message='We''''re sorry. You don''''t have access to these resources.' where [key]='label.noactivelicence';
update message set message='No active licence' where [key]='title.noactivelicence';
insert into message (id,basename,language,country,variant,[key],message) values (newId(), 'messages',null,null,null,'label.noactivelicence1','If you wish to continue to use these resources you will need to');
insert into message (id,basename,language,country,variant,[key],message) values (newId(), 'messages',null,null,null,'label.licenceDetails','Licence details');

-- EAC-190 - friendly 404
insert into message (id,basename,language,country,variant,[key],message) values (newId(), 'messages',null,null,null,'title.notFound','Page Not Found');
insert into message (id,basename,language,country,variant,[key],message) values (newId(), 'messages',null,null,null,'label.notFound','Page not found');
insert into message (id,basename,language,country,variant,[key],message) values (newId(), 'messages',null,null,null,'label.pageNotFound','The page you requested could not be found. Please try a different link.');

-- Mantis 12627 - localised questions by country, then language
update element_country_restriction set locale = 'ja_JP' where locale = 'ja';
update element_country_restriction set locale = 'ko_KR' where locale = 'ko';